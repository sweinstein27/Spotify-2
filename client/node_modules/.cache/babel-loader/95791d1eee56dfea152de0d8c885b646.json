{"ast":null,"code":"import _classCallCheck from \"/home/learn/Spotify-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/learn/Spotify-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/learn/Spotify-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/learn/Spotify-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/learn/Spotify-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/learn/Spotify-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/learn/Spotify-2/client/src/components/Player.js\";\nimport React, { Component } from 'react';\nimport SpotifyWebApi from 'spotify-web-api-js';\nimport $ from 'jquery';\nimport { connect } from \"react-redux\";\nimport { addToken } from \"../js/actions/index\";\nvar spotifyApi = new SpotifyWebApi();\nvar trackID;\nvar trackProgress;\nvar token;\nvar minutes;\nvar seconds;\n\nvar Player =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Player, _Component);\n\n  function Player(props) {\n    var _this;\n\n    _classCallCheck(this, Player);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Player).call(this, props));\n    _this.state = {\n      loggedIn: token ? true : false,\n      nowPlaying: {\n        name: 'Not Checked',\n        albumArt: '',\n        trackProgress: 0,\n        minutes: 0,\n        seconds: 0\n      },\n      trackData: {\n        key: \"\",\n        bpm: \"\"\n      },\n      searchObject: [],\n      selectedSongID: \"\",\n      token: JSON.parse(localStorage.getItem('token')) || []\n    };\n    _this.getAudioDetails = _this.getAudioDetails.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  } // getHashParams() {\n  //   var hashParams = {};\n  //   var e, r = /([^&;=]+)=?([^&;]*)/g,\n  //     q = window.location.hash.substring(1);\n  //   e = r.exec(q)\n  //   while (e) {\n  //     hashParams[e[1]] = decodeURIComponent(e[2]);\n  //     e = r.exec(q);\n  //   }\n  //   return hashParams;\n  // }\n\n\n  _createClass(Player, [{\n    key: \"getNowPlaying\",\n    value: function getNowPlaying() {\n      var _this2 = this;\n\n      this.getToken();\n      token = this.state.token;\n      spotifyApi.setAccessToken(token);\n      spotifyApi.getMyCurrentPlaybackState().then(function (response) {\n        trackID = response.item.id;\n        trackProgress = response.progress_ms / 1000;\n\n        _this2.setState({\n          nowPlaying: {\n            name: response.item.name,\n            albumArt: response.item.album.images[0].url,\n            trackProgress: response.progress_ms / 1000,\n            minutes: Math.floor(trackProgress / 60),\n            seconds: Math.floor(trackProgress - Math.floor(trackProgress / 60) * 60)\n          }\n        });\n      });\n      this.getAudioDetails();\n    }\n  }, {\n    key: \"getToken\",\n    value: function getToken() {\n      var _this3 = this;\n\n      var _abc = \"abc\",\n          token = _abc.token;\n      var payload = this.props.addToken({\n        token: token\n      });\n      this.setState({\n        token: payload.token\n      }, function () {\n        localStorage.setItem('token', JSON.stringify(_this3.state.token));\n      });\n    }\n  }, {\n    key: \"getAudioDetails\",\n    value: function getAudioDetails() {\n      var _this4 = this;\n\n      this.getToken();\n      token = this.state.token;\n      spotifyApi.setAccessToken(token);\n      var Url = \"https://api.spotify.com/v1/audio-analysis/\" + \"\".concat(trackID);\n      fetch(Url, {\n        method: \"GET\",\n        mode: \"cors\",\n        // no-cors, cors, *same-origin\n        cache: \"no-cache\",\n        // *default, no-cache, reload, force-cache, only-if-cached\n        credentials: \"same-origin\",\n        headers: {\n          'Authorization': \"Bearer \".concat(token),\n          \"Content-Type\": \"application/json\"\n        }\n      }).then(function (response) {\n        return response.json();\n      }).then(function (response) {\n        _this4.setState({\n          trackData: {\n            key: response.track.key,\n            bpm: response.track.tempo\n          }\n        });\n      });\n    }\n  }, {\n    key: \"getPause\",\n    value: function getPause() {\n      this.getToken();\n      token = this.state.token;\n      spotifyApi.setAccessToken(token);\n      spotifyApi.pause();\n      this.getNowPlaying();\n    }\n  }, {\n    key: \"getPlay\",\n    value: function getPlay() {\n      this.getToken();\n      debugger;\n      token = this.state.token;\n      spotifyApi.setAccessToken(token);\n      spotifyApi.play();\n      this.getNowPlaying();\n    }\n  }, {\n    key: \"skipSong\",\n    value: function skipSong() {\n      this.getToken();\n      token = this.state.token;\n      spotifyApi.setAccessToken(token);\n      spotifyApi.skipToNext();\n      this.getNowPlaying();\n    }\n  }, {\n    key: \"previousSong\",\n    value: function previousSong() {\n      this.getToken();\n      token = this.state.token;\n      spotifyApi.setAccessToken(token);\n      spotifyApi.skipToPrevious();\n      this.getNowPlaying();\n    } // seek(){\n    //   this.getToken()\n    //   token = this.state.token\n    //   spotifyApi.setAccessToken(token)\n    //   var newPosition = trackProgress + 30000\n    //   var Url = \"https://api.spotify.com/v1/me/player/seek?position_ms=\" + `${newPosition}`\n    //   $.ajax({\n    //   url: Url,\n    //   headers: {\n    //     'Authorization': `Bearer ${token}`,\n    //   },\n    //     type: \"PUT\",\n    //     contentType: JSON,\n    //     success: function(data){\n    //       console.log(\"success\")\n    //     },\n    //     error: function(error){\n    //       console.log(`Error is ${error}`)\n    //     }\n    //   })\n    // }\n    // search(){\n    //   $.ajax({\n    //     url: \"https://api.spotify.com/v1/search?q=abba&type=track&market=US&offset=0\",\n    //     headers: {\n    //       'Authorization': `Bearer ${token}`,\n    //     },\n    //     type: \"GET\",\n    //     contentType: JSON,\n    //   })\n    //   .then ((data) => {\n    //     debugger\n    //       this.setState({\n    //           searchObject: data.tracks.items\n    //       })\n    //   })\n    // }\n\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this5 = this;\n\n      this.interval = setInterval(function () {\n        return _this5.getNowPlaying();\n      }, 1000);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      clearInterval(this.interval);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this6 = this;\n\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        class: \"SongInfo text-white\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        class: \"col-sm-12 d-flex justify-content-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, \"Now Playing: \", this.state.nowPlaying.name), React.createElement(\"div\", {\n        class: \"col-sm-12 d-flex justify-content-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, \"Current Position: \", this.state.nowPlaying.minutes, \" minutes \", this.state.nowPlaying.seconds, \" seconds\"), React.createElement(\"div\", {\n        class: \"col-sm-12 d-flex justify-content-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, \"Key: \", this.state.trackData.key), React.createElement(\"div\", {\n        class: \"col-sm-12 d-flex justify-content-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, \"BPM: \", this.state.trackData.bpm), React.createElement(\"div\", {\n        class: \"col-sm-12 d-flex justify-content-center mb-md-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: this.state.nowPlaying.albumArt,\n        alt: \"Album Art\",\n        style: {\n          height: 250,\n          outerWidth: 250\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        class: \"btn-group d-flex justify-content-center mb-md-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        class: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        class: \"col-lg-3 d-flex justify-content-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        class: \"btn btn-default\",\n        onClick: function onClick() {\n          return _this6.previousSong();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: \"https://image.flaticon.com/icons/svg/149/149113.svg\",\n        alt: \"Previous Song\",\n        style: {\n          height: 50\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        class: \"col-lg-3 d-flex justify-content-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        class: \"btn btn-success\",\n        onClick: function onClick() {\n          return _this6.getPlay();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: \"https://image.flaticon.com/icons/svg/0/375.svg\",\n        alt: \"Play\",\n        style: {\n          height: 50\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        class: \"col-lg-3 d-flex justify-content-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        class: \"btn btn-danger\",\n        onClick: function onClick() {\n          return _this6.getPause();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: \"https://www.flaticon.com/premium-icon/icons/svg/1709/1709943.svg\",\n        alt: \"Pause\",\n        style: {\n          height: 50\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        class: \"col-lg-3 d-flex justify-content-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        class: \"btn btn-default\",\n        onClick: function onClick() {\n          return _this6.skipSong();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: \"https://image.flaticon.com/icons/svg/149/149112.svg\",\n        alt: \"Skip Song\",\n        style: {\n          height: 50\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232\n        },\n        __self: this\n      }))))));\n    }\n  }]);\n\n  return Player;\n}(Component);\n\nfunction mapStateToProps(state) {\n  return {\n    token: state.token\n  };\n}\n\nexport default connect(mapStateToProps, {\n  addToken: addToken\n})(Player);","map":{"version":3,"sources":["/home/learn/Spotify-2/client/src/components/Player.js"],"names":["React","Component","SpotifyWebApi","$","connect","addToken","spotifyApi","trackID","trackProgress","token","minutes","seconds","Player","props","state","loggedIn","nowPlaying","name","albumArt","trackData","key","bpm","searchObject","selectedSongID","JSON","parse","localStorage","getItem","getAudioDetails","bind","getToken","setAccessToken","getMyCurrentPlaybackState","then","response","item","id","progress_ms","setState","album","images","url","Math","floor","payload","setItem","stringify","Url","fetch","method","mode","cache","credentials","headers","json","track","tempo","pause","getNowPlaying","play","skipToNext","skipToPrevious","interval","setInterval","clearInterval","height","outerWidth","previousSong","getPlay","getPause","skipSong","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport SpotifyWebApi from 'spotify-web-api-js';\nimport $ from 'jquery';\nimport { connect } from \"react-redux\";\nimport { addToken } from \"../js/actions/index\";\n\n\n\n\nconst spotifyApi = new SpotifyWebApi();\nvar trackID;\nvar trackProgress;\nvar token ;\nvar minutes;\nvar seconds;\n\n\n\n\nclass Player extends Component {\n  constructor(props){\n    super(props);\n    \n    this.state = {\n      loggedIn: token ? true : false,\n      nowPlaying: { name: 'Not Checked', albumArt: '', trackProgress: 0, minutes: 0, seconds: 0 },\n      trackData: {\n        key: \"\",\n        bpm: \"\"\n      },\n      searchObject: [],\n      selectedSongID: \"\",\n      token: JSON.parse(localStorage.getItem('token')) || []\n    }\n    this.getAudioDetails = this.getAudioDetails.bind(this);\n  }\n\n\n  // getHashParams() {\n  //   var hashParams = {};\n  //   var e, r = /([^&;=]+)=?([^&;]*)/g,\n  //     q = window.location.hash.substring(1);\n  //   e = r.exec(q)\n  //   while (e) {\n  //     hashParams[e[1]] = decodeURIComponent(e[2]);\n  //     e = r.exec(q);\n  //   }\n  //   return hashParams;\n  // }\n\n  getNowPlaying(){\n    this.getToken()\n    token = this.state.token\n    spotifyApi.setAccessToken(token)\n    spotifyApi.getMyCurrentPlaybackState()\n    .then((response) => {\n    trackID = response.item.id\n    trackProgress = response.progress_ms/1000\n    this.setState({\n        nowPlaying: { \n        name: response.item.name, \n        albumArt: response.item.album.images[0].url,\n        trackProgress: response.progress_ms/1000,\n        minutes: Math.floor(trackProgress / 60),\n        seconds: Math.floor(trackProgress -  (Math.floor(trackProgress/60) * 60))\n        }\n    });\n    })\n    this.getAudioDetails()\n}\n\n  getToken(){\n    var { token } = \"abc\";\n    var payload = this.props.addToken({ token });\n    this.setState({\n      token: payload.token\n    }, () => {\n      localStorage.setItem('token', JSON.stringify(this.state.token))\n    })\n  }\n\n  getAudioDetails() {\n    this.getToken()\n    token = this.state.token\n    spotifyApi.setAccessToken(token)\n    var Url = \"https://api.spotify.com/v1/audio-analysis/\" + `${trackID}`\n    fetch(Url, {\n      method: \"GET\",\n      mode: \"cors\", // no-cors, cors, *same-origin\n      cache: \"no-cache\", // *default, no-cache, reload, force-cache, only-if-cached\n      credentials: \"same-origin\",\n      headers: {\n        'Authorization': `Bearer ${token}`,\n        \"Content-Type\": \"application/json\"\n      },\n    }).then(response => response.json())\n    .then((response) => {\n      this.setState({\n        trackData: {\n          key: response.track.key,\n          bpm: response.track.tempo\n        }\n      })\n    })\n  }\n\n  getPause() {\n    this.getToken()\n    token = this.state.token\n    spotifyApi.setAccessToken(token)\n    spotifyApi.pause()\n    this.getNowPlaying()\n  }\n\n  getPlay(){\n    this.getToken()\n    debugger\n    token = this.state.token\n    spotifyApi.setAccessToken(token)\n    spotifyApi.play()\n    this.getNowPlaying()\n  }\n\n  skipSong(){\n    this.getToken()\n    token = this.state.token\n    spotifyApi.setAccessToken(token)\n    spotifyApi.skipToNext()\n    this.getNowPlaying()\n  }\n\n  previousSong(){\n    this.getToken()\n    token = this.state.token\n    spotifyApi.setAccessToken(token)\n    spotifyApi.skipToPrevious()\n    this.getNowPlaying()\n  }\n\n  // seek(){\n  //   this.getToken()\n  //   token = this.state.token\n  //   spotifyApi.setAccessToken(token)\n  //   var newPosition = trackProgress + 30000\n  //   var Url = \"https://api.spotify.com/v1/me/player/seek?position_ms=\" + `${newPosition}`\n  //   $.ajax({\n  //   url: Url,\n  //   headers: {\n  //     'Authorization': `Bearer ${token}`,\n  //   },\n  //     type: \"PUT\",\n  //     contentType: JSON,\n  //     success: function(data){\n  //       console.log(\"success\")\n  //     },\n  //     error: function(error){\n  //       console.log(`Error is ${error}`)\n  //     }\n  //   })\n  // }\n\n  // search(){\n  //   $.ajax({\n  //     url: \"https://api.spotify.com/v1/search?q=abba&type=track&market=US&offset=0\",\n  //     headers: {\n  //       'Authorization': `Bearer ${token}`,\n  //     },\n  //     type: \"GET\",\n  //     contentType: JSON,\n  //   })\n  //   .then ((data) => {\n  //     debugger\n  //       this.setState({\n  //           searchObject: data.tracks.items\n  //       })\n  //   })\n  // }\n\n \n\n    componentDidMount(){\n      this.interval = setInterval(() => this.getNowPlaying(), 1000);\n    }\n\n    componentWillUnmount() {\n      clearInterval(this.interval);\n    }\n\n  \n    \n  render() {\n    return (\n      <div className=\"App\">\n        <div class=\"SongInfo text-white\">\n        {/* <div class=\"d-flex justify-content-center\"> */}\n            <div class=\"col-sm-12 d-flex justify-content-center\">\n            Now Playing: { this.state.nowPlaying.name }\n            </div>\n            <div class=\"col-sm-12 d-flex justify-content-center\">\n            Current Position: {this.state.nowPlaying.minutes} minutes { this.state.nowPlaying.seconds} seconds\n            </div>\n            <div class=\"col-sm-12 d-flex justify-content-center\">\n            Key: { this.state.trackData.key }  \n            </div>\n            <div class=\"col-sm-12 d-flex justify-content-center\">\n            BPM: { this.state.trackData.bpm } \n            </div>\n            <div class=\"col-sm-12 d-flex justify-content-center mb-md-3\">\n            <img src={this.state.nowPlaying.albumArt} alt=\"Album Art\" style={{ height: 250, outerWidth: 250 }}/>\n            </div>\n        {/* </div> */}\n        </div>\n        <div class=\"btn-group d-flex justify-content-center mb-md-3\">\n            <div class=\"row\">\n            <div class=\"col-lg-3 d-flex justify-content-center\">\n                <button class=\"btn btn-default\" onClick={() => this.previousSong()}>\n                <img src=\"https://image.flaticon.com/icons/svg/149/149113.svg\" alt=\"Previous Song\" style={{ height: 50}}/>\n                </button>\n            </div>\n            <div class=\"col-lg-3 d-flex justify-content-center\" >\n                <button class=\"btn btn-success\" onClick={() => this.getPlay()}>\n                    <img src=\"https://image.flaticon.com/icons/svg/0/375.svg\" alt=\"Play\" style={{ height: 50}}/>\n                </button>\n            </div>\n            <div class=\"col-lg-3 d-flex justify-content-center\">\n                <button class=\"btn btn-danger\" onClick={() => this.getPause()}>\n                <img src=\"https://www.flaticon.com/premium-icon/icons/svg/1709/1709943.svg\" alt=\"Pause\" style={{ height: 50}}/>\n                </button>\n            </div>\n            <div class=\"col-lg-3 d-flex justify-content-center\">\n                <button class=\"btn btn-default\" onClick={() => this.skipSong()}>\n                <img src=\"https://image.flaticon.com/icons/svg/149/149112.svg\" alt=\"Skip Song\" style={{ height: 50}}/>\n                </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps(state) {\n    return {\n      token: state.token\n    };\n  }\n  \n  export default connect(\n    mapStateToProps,\n    { addToken }\n  )(Player);"]},"metadata":{},"sourceType":"module"}